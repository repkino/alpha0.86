{
	"name": "_scompi",
	"events": [
		{
			"eventType": "comment",
			"text": "план АРХИТЕКТУРЫ SCOMPI_BRAIN (Лист _scompi) \n\n\"Scompi_Brain\" — это стейт-машина (Finite State Machine), управляющая поведением питомца. Лист разбивается на логические группы, которые включаются/выключаются (set-group-active) для экономии ресурсов и изоляции логики.\n\n[ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ СКОМПИ]\n- sHunger (number): 0-100. Растет по таймеру.\n- sState (string): \"chill\", \"hungry\", \"naughty\" (проказит), \"crazy\" (100% голода), \"eating\", \"dialogue\".\n- sLoc (string): \"bit\" (на плече), \"inv\" (в ячейке), \"far_inv\" (в конце инвентаря для дразнения), \"map\" (навигатор).\n- sIsBusy (boolean): флаг, запрещающий Биту использовать Скомпи как способность (например, если Скомпи сейчас жрет инвентарь, им нельзя атаковать).\n\n[ГРУППА: Scompi_Tick (Всегда активна)]\n- Отвечает за инкремент голода (каждые X секунд).\n- Проверяет пороги `sHunger`:\n  - > 50%: Меняет анимацию на \"показывает в рот\" (если `sState` == \"chill\").\n  - > 80%: Меняет `sState` на \"naughty\". Запускает сигнал вторжения в инвентарь (сдвиг предметов).\n  - == 100%: Запускает \"Критический голод\" (проверка наличия еды и выбор сценария).\n\n[ГРУППА: Scompi_Inventory_Logic (Включается когда sLoc == \"inv\")]\n- Переопределяет логику сортировки. Скомпи заставляет функцию `cellN` (лист _UI) игнорировать его обычный UID и жестко ставит себе `cellN = 1` (если голоден) или `cellN = 2` (если просто отдыхает).\n- Обрабатывает Drag&Drop: если на Скомпи бросают предмет (`on-drop` предмет на Скомпи), запускается анимация жевания, `sHunger` сбрасывается, с 20% шансом генерируется семечко (через `getItem`).\n\n[ГРУППА: Scompi_Critical (Срабатывает при sHunger == 100)]\n- Функция `scompiCheckFood`: проверяет словарь `itemsQ`.\n  - СЦЕНАРИЙ 1 (Еда есть): \n    1. Перехват управления (блокировка кликов).\n    2. Сигнал закрытия инвентаря.\n    3. Экранная тряска (плагин Shake или Tween позиции камеры).\n    4. Цикл `for-each-key` в `itemsQ` — обнуление съедобных ключей.\n    5. Сигнал открытия инвентаря: Скомпи сидит толстый и довольный (`sState` = \"fat_chill\").\n  - СЦЕНАРИЙ 2 (Еды нет):\n    1. Скомпи переходит в `sState` = \"crazy\" (глаза-спирали).\n    2. Вызывает кастомный триггер: либо зомби-режим (блокирует первую ячейку и спамит звуками), либо агрессия на Бита (вызывает функцию респауна / вмешательство Сова).\n"
		},
		{
			"eventType": "block",
			"conditions": [
				{
					"id": "on-start-of-layout",
					"objectClass": "System",
					"sid": 760233027331312
				},
				{
					"id": "compare-two-values",
					"objectClass": "System",
					"sid": 130512734991940,
					"parameters": {
						"first-value": "LayoutName",
						"comparison": 1,
						"second-value": "\"start\""
					}
				},
				{
					"id": "compare-instance-variable",
					"objectClass": "aTools",
					"sid": 406457949867026,
					"parameters": {
						"instance-variable": "n",
						"comparison": 0,
						"value": "frame.n"
					}
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "временные действия ",
					"background-color": [
						0.996078431372549,
						0.7450980392156863,
						0.9882352941176471,
						1
					]
				},
				{
					"id": "set-group-active",
					"objectClass": "System",
					"sid": 757123439582755,
					"parameters": {
						"group-name": "\"scompi\"",
						"state": "activated"
					}
				},
				{
					"id": "set-group-active",
					"objectClass": "System",
					"sid": 222884204278939,
					"parameters": {
						"group-name": "\"uiDialogs\"",
						"state": "activated"
					}
				}
			],
			"sid": 913220744919309
		},
		{
			"eventType": "comment",
			"text": ""
		},
		{
			"eventType": "group",
			"disabled": false,
			"title": "scompi",
			"description": "",
			"isActiveOnStart": false,
			"children": [
				{
					"eventType": "comment",
					"text": "демонстрация переменных"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "trigger-once-while-true",
							"objectClass": "System",
							"sid": 191342250953718
						},
						{
							"id": "is-boolean-instance-variable-set",
							"objectClass": "aScompi",
							"sid": 628728912596044,
							"parameters": {
								"instance-variable": "sIsBusy"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "aScompi",
							"sid": 804875048922323,
							"parameters": {
								"instance-variable": "sHunger",
								"comparison": 0,
								"value": "0"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "aScompi",
							"sid": 993081155724969,
							"parameters": {
								"instance-variable": "sLoc",
								"comparison": 0,
								"value": "\"Bit\""
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "aScompi",
							"sid": 776227676531029,
							"parameters": {
								"instance-variable": "sState",
								"comparison": 0,
								"value": "\"chill\""
							}
						},
						{
							"id": "is-outside-layout",
							"objectClass": "cocoFX",
							"sid": 490997827987964
						}
					],
					"actions": [],
					"sid": 432110887280293,
					"disabled": true,
					"children": [
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "pick-random-instance",
									"objectClass": "System",
									"sid": 871144908308677,
									"parameters": {
										"object": "cocoFX"
									}
								}
							],
							"actions": [
								{
									"id": "set-position",
									"objectClass": "cocoFX",
									"sid": 306663997114043,
									"parameters": {
										"x": "Mouse.X",
										"y": "Mouse.Y"
									}
								},
								{
									"id": "set-animation",
									"objectClass": "cocoFX",
									"sid": 873997607950622,
									"parameters": {
										"animation": "\"fx\"",
										"from": "beginning"
									}
								},
								{
									"id": "start-animation",
									"objectClass": "cocoFX",
									"sid": 496803085426109,
									"parameters": {
										"from": "beginning"
									}
								}
							],
							"sid": 821393340354458,
							"disabled": true
						}
					]
				},
				{
					"eventType": "comment",
					"text": ""
				},
				{
					"eventType": "group",
					"disabled": false,
					"title": "scompiBrain",
					"description": "",
					"isActiveOnStart": true,
					"children": [
						{
							"eventType": "comment",
							"text": "Таймер голода Скомпи. Увеличиваем голод каждые 5 секунд (настроить по балансу)",
							"background-color": [
								0.33,
								0.73,
								0.48,
								1
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "every-x-seconds",
									"objectClass": "System",
									"sid": 847291048271948,
									"parameters": {
										"interval-seconds": "5.0"
									}
								},
								{
									"id": "compare-instance-variable",
									"objectClass": "aScompi",
									"sid": 192837465019283,
									"parameters": {
										"instance-variable": "sHunger",
										"comparison": 2,
										"value": "100"
									}
								}
							],
							"actions": [
								{
									"id": "add-to-instvar",
									"objectClass": "aScompi",
									"sid": 583920184756291,
									"parameters": {
										"instance-variable": "sHunger",
										"value": "2"
									}
								}
							],
							"sid": 482910384756102
						},
						{
							"eventType": "comment",
							"text": "Ограничитель голода (Clamp 0-100)",
							"background-color": [
								0.33,
								0.73,
								0.48,
								1
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "aScompi",
									"sid": 572819304857192,
									"parameters": {
										"instance-variable": "sHunger",
										"comparison": 4,
										"value": "100"
									}
								}
							],
							"actions": [
								{
									"id": "set-instvar-value",
									"objectClass": "aScompi",
									"sid": 192837465102938,
									"parameters": {
										"instance-variable": "sHunger",
										"value": "100"
									}
								}
							],
							"sid": 485729103847561
						},
						{
							"eventType": "comment",
							"text": "Машина состояний (State Machine) на основе уровня голода",
							"background-color": [
								0.33,
								0.73,
								0.48,
								1
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "compare-instance-variable",
									"objectClass": "aScompi",
									"sid": 582910384756192,
									"parameters": {
										"instance-variable": "sHunger",
										"comparison": 5,
										"value": "80"
									}
								}
							],
							"actions": [],
							"sid": 384756102938475,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "aScompi",
											"sid": 102938475610293,
											"parameters": {
												"instance-variable": "sState",
												"comparison": 1,
												"value": "\"crazy\""
											}
										}
									],
									"actions": [
										{
											"id": "set-instvar-value",
											"objectClass": "aScompi",
											"sid": 485719203847561,
											"parameters": {
												"instance-variable": "sState",
												"value": "\"crazy\""
											}
										},
										{
											"id": "signal",
											"objectClass": "System",
											"sid": 582910384756102,
											"parameters": {
												"tag": "\"scompi_crazy_start\""
											}
										}
									],
									"sid": 293847561029384
								}
							]
						},
						{
							"eventType": "block",
							"conditions": [
								{
									"id": "else",
									"objectClass": "System",
									"sid": 485719203847562
								}
							],
							"actions": [],
							"sid": 192837465019284,
							"children": [
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "compare-instance-variable",
											"objectClass": "aScompi",
											"sid": 582910384756103,
											"parameters": {
												"instance-variable": "sHunger",
												"comparison": 5,
												"value": "50"
											}
										}
									],
									"actions": [],
									"sid": 384756102938476,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-instance-variable",
													"objectClass": "aScompi",
													"sid": 102938475610294,
													"parameters": {
														"instance-variable": "sState",
														"comparison": 1,
														"value": "\"hungry\""
													}
												}
											],
											"actions": [
												{
													"id": "set-instvar-value",
													"objectClass": "aScompi",
													"sid": 485719203847563,
													"parameters": {
														"instance-variable": "sState",
														"value": "\"hungry\""
													}
												},
												{
													"id": "signal",
													"objectClass": "System",
													"sid": 582910384756104,
													"parameters": {
														"tag": "\"scompi_hungry_start\""
													}
												}
											],
											"sid": 293847561029385
										}
									]
								},
								{
									"eventType": "block",
									"conditions": [
										{
											"id": "else",
											"objectClass": "System",
											"sid": 485719203847564
										}
									],
									"actions": [],
									"sid": 192837465019285,
									"children": [
										{
											"eventType": "block",
											"conditions": [
												{
													"id": "compare-instance-variable",
													"objectClass": "aScompi",
													"sid": 102938475610295,
													"parameters": {
														"instance-variable": "sState",
														"comparison": 1,
														"value": "\"chill\""
													}
												}
											],
											"actions": [
												{
													"id": "set-instvar-value",
													"objectClass": "aScompi",
													"sid": 485719203847565,
													"parameters": {
														"instance-variable": "sState",
														"value": "\"chill\""
													}
												},
												{
													"id": "signal",
													"objectClass": "System",
													"sid": 582910384756105,
													"parameters": {
														"tag": "\"scompi_chill_start\""
													}
												}
											],
											"sid": 293847561029386
										}
									]
								}
							]
						}
					],
					"sid": 839201847561029
				}
			],
			"sid": 715233710309486
		}
	],
	"sid": 835245021672416
}